#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/* Sorted list of Xlib functions that we shall not interrupt.
   A coarsely composed list:
from
   nm -D /usr/X11R6/lib/libX11.so | grep ' T ' | cut -f3 -d' '
delete those that can block:
   XNextEvent, XIfEvent, XWindowEvent, XMaskEvent, XPeekEvent, XPeekIfEvent
*/
static char *xfns[] = {
"KeySymToUcs4",
"XActivateScreenSaver",
"XAddConnectionWatch",
"XAddExtension",
"XAddHost",
"XAddHosts",
"XAddPixel",
"XAddToExtensionList",
"XAddToSaveSet",
"XAllPlanes",
"XAllocClassHint",
"XAllocColor",
"XAllocColorCells",
"XAllocColorPlanes",
"XAllocIconSize",
"XAllocNamedColor",
"XAllocSizeHints",
"XAllocStandardColormap",
"XAllocWMHints",
"XAllowEvents",
"XAutoRepeatOff",
"XAutoRepeatOn",
"XBaseFontNameListOfFontSet",
"XBell",
"XBitmapBitOrder",
"XBitmapPad",
"XBitmapUnit",
"XBlackPixel",
"XBlackPixelOfScreen",
"XCellsOfScreen",
"XChangeActivePointerGrab",
"XChangeGC",
"XChangeKeyboardControl",
"XChangeKeyboardMapping",
"XChangePointerControl",
"XChangeProperty",
"XChangeSaveSet",
"XChangeWindowAttributes",
"XCheckIfEvent",
"XCheckMaskEvent",
"XCheckTypedEvent",
"XCheckTypedWindowEvent",
"XCheckWindowEvent",
"XCirculateSubwindows",
"XCirculateSubwindowsDown",
"XCirculateSubwindowsUp",
"XClearArea",
"XClearWindow",
"XClipBox",
"XCloseDisplay",
"XCloseIM",
"XCloseOM",
"XConfigureWindow",
"XConnectionNumber",
"XContextDependentDrawing",
"XContextualDrawing",
"XConvertCase",
"XConvertSelection",
"XCopyArea",
"XCopyColormapAndFree",
"XCopyGC",
"XCopyPlane",
"XCreateBitmapFromData",
"XCreateColormap",
"XCreateFontCursor",
"XCreateFontSet",
"XCreateGC",
"XCreateGlyphCursor",
"XCreateIC",
"XCreateImage",
"XCreateOC",
"XCreatePixmap",
"XCreatePixmapCursor",
"XCreatePixmapFromBitmapData",
"XCreateRegion",
"XCreateSimpleWindow",
"XCreateWindow",
"XDefaultColormap",
"XDefaultColormapOfScreen",
"XDefaultDepth",
"XDefaultDepthOfScreen",
"XDefaultGC",
"XDefaultGCOfScreen",
"XDefaultRootWindow",
"XDefaultScreen",
"XDefaultScreenOfDisplay",
"XDefaultString",
"XDefaultVisual",
"XDefaultVisualOfScreen",
"XDefineCursor",
"XDeleteContext",
"XDeleteModifiermapEntry",
"XDeleteProperty",
"XDestroyIC",
"XDestroyImage",
"XDestroyOC",
"XDestroyRegion",
"XDestroySubwindows",
"XDestroyWindow",
"XDirectionalDependentDrawing",
"XDisableAccessControl",
"XDisplayCells",
"XDisplayHeight",
"XDisplayHeightMM",
"XDisplayKeycodes",
"XDisplayMotionBufferSize",
"XDisplayName",
"XDisplayOfIM",
"XDisplayOfOM",
"XDisplayOfScreen",
"XDisplayPlanes",
"XDisplayString",
"XDisplayWidth",
"XDisplayWidthMM",
"XDoesBackingStore",
"XDoesSaveUnders",
"XDrawArc",
"XDrawArcs",
"XDrawImageString",
"XDrawImageString16",
"XDrawLine",
"XDrawLines",
"XDrawPoint",
"XDrawPoints",
"XDrawRectangle",
"XDrawRectangles",
"XDrawSegments",
"XDrawString",
"XDrawString16",
"XDrawText",
"XDrawText16",
"XEHeadOfExtensionList",
"XESetBeforeFlush",
"XESetCloseDisplay",
"XESetCopyGC",
"XESetCreateFont",
"XESetCreateGC",
"XESetError",
"XESetErrorString",
"XESetEventToWire",
"XESetFlushGC",
"XESetFreeFont",
"XESetFreeGC",
"XESetPrintErrorValues",
"XESetWireToError",
"XESetWireToEvent",
"XEmptyRegion",
"XEnableAccessControl",
"XEqualRegion",
"XEventMaskOfScreen",
"XEventsQueued",
"XExtendedMaxRequestSize",
"XExtentsOfFontSet",
"XFetchBuffer",
"XFetchBytes",
"XFetchName",
"XFillArc",
"XFillArcs",
"XFillPolygon",
"XFillRectangle",
"XFillRectangles",
"XFilterEvent",
"XFindContext",
"XFindOnExtensionList",
"XFlush",
"XFlushGC",
"XFontsOfFontSet",
"XForceScreenSaver",
"XFree",
"XFreeColormap",
"XFreeColors",
"XFreeCursor",
"XFreeExtensionList",
"XFreeFont",
"XFreeFontInfo",
"XFreeFontNames",
"XFreeFontPath",
"XFreeFontSet",
"XFreeGC",
"XFreeModifiermap",
"XFreePixmap",
"XFreeStringList",
"XGContextFromGC",
"XGeometry",
"XGetAtomName",
"XGetAtomNames",
"XGetClassHint",
"XGetCommand",
"XGetDefault",
"XGetErrorDatabaseText",
"XGetErrorText",
"XGetFontPath",
"XGetFontProperty",
"XGetGCValues",
"XGetGeometry",
"XGetICValues",
"XGetIMValues",
"XGetIconName",
"XGetIconSizes",
"XGetImage",
"XGetInputFocus",
"XGetKeyboardControl",
"XGetKeyboardMapping",
"XGetModifierMapping",
"XGetMotionEvents",
"XGetNormalHints",
"XGetOCValues",
"XGetOMValues",
"XGetPixel",
"XGetPointerControl",
"XGetPointerMapping",
"XGetRGBColormaps",
"XGetScreenSaver",
"XGetSelectionOwner",
"XGetSizeHints",
"XGetStandardColormap",
"XGetSubImage",
"XGetTextProperty",
"XGetTransientForHint",
"XGetVisualInfo",
"XGetWMClientMachine",
"XGetWMColormapWindows",
"XGetWMHints",
"XGetWMIconName",
"XGetWMName",
"XGetWMNormalHints",
"XGetWMProtocols",
"XGetWMSizeHints",
"XGetWindowAttributes",
"XGetWindowProperty",
"XGetZoomHints",
"XGrabButton",
"XGrabKey",
"XGrabKeyboard",
"XGrabPointer",
"XGrabServer",
"XHeightMMOfScreen",
"XHeightOfScreen",
"XIMOfIC",
"XIconifyWindow",
"XImageByteOrder",
"XInitExtension",
"XInitImage",
"XInitThreads",
"XInsertModifiermapEntry",
"XInstallColormap",
"XInternAtom",
"XInternAtoms",
"XInternalConnectionNumbers",
"XIntersectRegion",
"XKeycodeToKeysym",
"XKeysymToKeycode",
"XKeysymToString",
"XKillClient",
"XLastKnownRequestProcessed",
"XListDepths",
"XListExtensions",
"XListFonts",
"XListFontsWithInfo",
"XListHosts",
"XListInstalledColormaps",
"XListPixmapFormats",
"XListProperties",
"XLoadFont",
"XLoadQueryFont",
"XLocaleOfFontSet",
"XLocaleOfIM",
"XLocaleOfOM",
"XLockDisplay",
"XLookupColor",
"XLookupKeysym",
"XLookupString",
"XLowerWindow",
"XMapRaised",
"XMapSubwindows",
"XMapWindow",
"XMatchVisualInfo",
"XMaxCmapsOfScreen",
"XMaxRequestSize",
"XMinCmapsOfScreen",
"XMoveResizeWindow",
"XMoveWindow",
"XNewModifiermap",
"XNextRequest",
"XNoOp",
"XOMOfOC",
"XOffsetRegion",
"XOpenDisplay",
"XOpenIM",
"XOpenOM",
"XParseColor",
"XParseGeometry",
"XPending",
"XPlanesOfScreen",
"XPointInRegion",
"XPolygonRegion",
"XProcessInternalConnection",
"XProtocolRevision",
"XProtocolVersion",
"XPutBackEvent",
"XPutImage",
"XPutPixel",
"XQLength",
"XQueryBestCursor",
"XQueryBestSize",
"XQueryBestStipple",
"XQueryBestTile",
"XQueryColor",
"XQueryColors",
"XQueryExtension",
"XQueryFont",
"XQueryKeymap",
"XQueryPointer",
"XQueryTextExtents",
"XQueryTextExtents16",
"XQueryTree",
"XRaiseWindow",
"XReadBitmapFile",
"XReadBitmapFileData",
"XRebindKeysym",
"XRecolorCursor",
"XReconfigureWMWindow",
"XRectInRegion",
"XRefreshKeyboardMapping",
"XRegisterIMInstantiateCallback",
"XRemoveConnectionWatch",
"XRemoveFromSaveSet",
"XRemoveHost",
"XRemoveHosts",
"XReparentWindow",
"XResetScreenSaver",
"XResizeWindow",
"XResourceManagerString",
"XRestackWindows",
"XRootWindow",
"XRootWindowOfScreen",
"XRotateBuffers",
"XRotateWindowProperties",
"XSaveContext",
"XScreenCount",
"XScreenNumberOfScreen",
"XScreenOfDisplay",
"XScreenResourceString",
"XSelectInput",
"XSendEvent",
"XServerVendor",
"XSetAccessControl",
"XSetAfterFunction",
"XSetArcMode",
"XSetAuthorization",
"XSetBackground",
"XSetClassHint",
"XSetClipMask",
"XSetClipOrigin",
"XSetClipRectangles",
"XSetCloseDownMode",
"XSetCommand",
"XSetDashes",
"XSetErrorHandler",
"XSetFillRule",
"XSetFillStyle",
"XSetFont",
"XSetFontPath",
"XSetForeground",
"XSetFunction",
"XSetGraphicsExposures",
"XSetICFocus",
"XSetICValues",
"XSetIMValues",
"XSetIOErrorHandler",
"XSetIconName",
"XSetIconSizes",
"XSetInputFocus",
"XSetLineAttributes",
"XSetLocaleModifiers",
"XSetModifierMapping",
"XSetNormalHints",
"XSetOCValues",
"XSetOMValues",
"XSetPlaneMask",
"XSetPointerMapping",
"XSetRGBColormaps",
"XSetRegion",
"XSetScreenSaver",
"XSetSelectionOwner",
"XSetSizeHints",
"XSetStandardColormap",
"XSetStandardProperties",
"XSetState",
"XSetStipple",
"XSetSubwindowMode",
"XSetTSOrigin",
"XSetTextProperty",
"XSetTile",
"XSetTransientForHint",
"XSetWMClientMachine",
"XSetWMColormapWindows",
"XSetWMHints",
"XSetWMIconName",
"XSetWMName",
"XSetWMNormalHints",
"XSetWMProperties",
"XSetWMProtocols",
"XSetWMSizeHints",
"XSetWindowBackground",
"XSetWindowBackgroundPixmap",
"XSetWindowBorder",
"XSetWindowBorderPixmap",
"XSetWindowBorderWidth",
"XSetWindowColormap",
"XSetZoomHints",
"XShrinkRegion",
"XStoreBuffer",
"XStoreBytes",
"XStoreColor",
"XStoreColors",
"XStoreName",
"XStoreNamedColor",
"XStringListToTextProperty",
"XStringToKeysym",
"XSubImage",
"XSubtractRegion",
"XSupportsLocale",
"XSync",
"XSynchronize",
"XTextExtents",
"XTextExtents16",
"XTextPropertyToStringList",
"XTextWidth",
"XTextWidth16",
"XTranslateCoordinates",
"XUndefineCursor",
"XUngrabButton",
"XUngrabKey",
"XUngrabKeyboard",
"XUngrabPointer",
"XUngrabServer",
"XUninstallColormap",
"XUnionRectWithRegion",
"XUnionRegion",
"XUnloadFont",
"XUnlockDisplay",
"XUnmapSubwindows",
"XUnmapWindow",
"XUnregisterIMInstantiateCallback",
"XUnsetICFocus",
"XVaCreateNestedList",
"XVendorRelease",
"XVisualIDFromVisual",
"XWMGeometry",
"XWarpPointer",
"XWhitePixel",
"XWhitePixelOfScreen",
"XWidthMMOfScreen",
"XWidthOfScreen",
"XWithdrawWindow",
"XWriteBitmapFile",
"XXorRegion",
"XauDisposeAuth",
"XauFileName",
"XauGetBestAuthByAddr",
"XauReadAuth",
"XcmsAddColorSpace",
"XcmsAddFunctionSet",
"XcmsAllocColor",
"XcmsAllocNamedColor",
"XcmsCCCOfColormap",
"XcmsCIELabClipL",
"XcmsCIELabClipLab",
"XcmsCIELabClipab",
"XcmsCIELabQueryMaxC",
"XcmsCIELabQueryMaxL",
"XcmsCIELabQueryMaxLC",
"XcmsCIELabQueryMinL",
"XcmsCIELabToCIEXYZ",
"XcmsCIELabWhiteShiftColors",
"XcmsCIELuvClipL",
"XcmsCIELuvClipLuv",
"XcmsCIELuvClipuv",
"XcmsCIELuvQueryMaxC",
"XcmsCIELuvQueryMaxL",
"XcmsCIELuvQueryMaxLC",
"XcmsCIELuvQueryMinL",
"XcmsCIELuvToCIEuvY",
"XcmsCIELuvWhiteShiftColors",
"XcmsCIEXYZToCIELab",
"XcmsCIEXYZToCIEuvY",
"XcmsCIEXYZToCIExyY",
"XcmsCIEXYZToRGBi",
"XcmsCIEuvYToCIELuv",
"XcmsCIEuvYToCIEXYZ",
"XcmsCIEuvYToTekHVC",
"XcmsCIExyYToCIEXYZ",
"XcmsClientWhitePointOfCCC",
"XcmsConvertColors",
"XcmsCreateCCC",
"XcmsDefaultCCC",
"XcmsDisplayOfCCC",
"XcmsFormatOfPrefix",
"XcmsFreeCCC",
"XcmsLookupColor",
"XcmsPrefixOfFormat",
"XcmsQueryBlack",
"XcmsQueryBlue",
"XcmsQueryColor",
"XcmsQueryColors",
"XcmsQueryGreen",
"XcmsQueryRed",
"XcmsQueryWhite",
"XcmsRGBToRGBi",
"XcmsRGBiToCIEXYZ",
"XcmsRGBiToRGB",
"XcmsScreenNumberOfCCC",
"XcmsScreenWhitePointOfCCC",
"XcmsSetCCCOfColormap",
"XcmsSetCompressionProc",
"XcmsSetWhiteAdjustProc",
"XcmsSetWhitePoint",
"XcmsStoreColor",
"XcmsStoreColors",
"XcmsTekHVCClipC",
"XcmsTekHVCClipV",
"XcmsTekHVCClipVC",
"XcmsTekHVCQueryMaxC",
"XcmsTekHVCQueryMaxV",
"XcmsTekHVCQueryMaxVC",
"XcmsTekHVCQueryMaxVSamples",
"XcmsTekHVCQueryMinV",
"XcmsTekHVCToCIEuvY",
"XcmsTekHVCWhiteShiftColors",
"XcmsVisualOfCCC",
"XkbAddDeviceLedInfo",
"XkbAddGeomColor",
"XkbAddGeomDoodad",
"XkbAddGeomKey",
"XkbAddGeomKeyAlias",
"XkbAddGeomOutline",
"XkbAddGeomOverlay",
"XkbAddGeomOverlayKey",
"XkbAddGeomOverlayRow",
"XkbAddGeomProperty",
"XkbAddGeomRow",
"XkbAddGeomSection",
"XkbAddGeomShape",
"XkbAddKeyType",
"XkbAllocClientMap",
"XkbAllocCompatMap",
"XkbAllocControls",
"XkbAllocDeviceInfo",
"XkbAllocGeomColors",
"XkbAllocGeomDoodads",
"XkbAllocGeomKeyAliases",
"XkbAllocGeomKeys",
"XkbAllocGeomOutlines",
"XkbAllocGeomOverlayKeys",
"XkbAllocGeomOverlayRows",
"XkbAllocGeomOverlays",
"XkbAllocGeomPoints",
"XkbAllocGeomProps",
"XkbAllocGeomRows",
"XkbAllocGeomSectionDoodads",
"XkbAllocGeomSections",
"XkbAllocGeomShapes",
"XkbAllocGeometry",
"XkbAllocIndicatorMaps",
"XkbAllocKeyboard",
"XkbAllocNames",
"XkbAllocServerMap",
"XkbApplyCompatMapToKey",
"XkbApplyVirtualModChanges",
"XkbBell",
"XkbBellEvent",
"XkbChangeDeviceInfo",
"XkbChangeEnabledControls",
"XkbChangeKeycodeRange",
"XkbChangeMap",
"XkbChangeNames",
"XkbChangeTypesOfKey",
"XkbComputeEffectiveMap",
"XkbComputeRowBounds",
"XkbComputeSectionBounds",
"XkbComputeShapeBounds",
"XkbComputeShapeTop",
"XkbCopyKeyType",
"XkbCopyKeyTypes",
"XkbDeviceBell",
"XkbDeviceBellEvent",
"XkbFindOverlayForKey",
"XkbForceBell",
"XkbForceDeviceBell",
"XkbFreeClientMap",
"XkbFreeCompatMap",
"XkbFreeComponentList",
"XkbFreeControls",
"XkbFreeDeviceInfo",
"XkbFreeGeomColors",
"XkbFreeGeomDoodads",
"XkbFreeGeomKeyAliases",
"XkbFreeGeomKeys",
"XkbFreeGeomOutlines",
"XkbFreeGeomOverlayKeys",
"XkbFreeGeomOverlayRows",
"XkbFreeGeomOverlays",
"XkbFreeGeomPoints",
"XkbFreeGeomProperties",
"XkbFreeGeomRows",
"XkbFreeGeomSections",
"XkbFreeGeomShapes",
"XkbFreeGeometry",
"XkbFreeIndicatorMaps",
"XkbFreeKeyboard",
"XkbFreeNames",
"XkbFreeServerMap",
"XkbGetAutoRepeatRate",
"XkbGetAutoResetControls",
"XkbGetCompatMap",
"XkbGetControls",
"XkbGetDetectableAutoRepeat",
"XkbGetDeviceButtonActions",
"XkbGetDeviceInfo",
"XkbGetDeviceInfoChanges",
"XkbGetDeviceLedInfo",
"XkbGetGeometry",
"XkbGetIndicatorMap",
"XkbGetIndicatorState",
"XkbGetKeyActions",
"XkbGetKeyBehaviors",
"XkbGetKeyExplicitComponents",
"XkbGetKeyModifierMap",
"XkbGetKeySyms",
"XkbGetKeyTypes",
"XkbGetKeyVirtualModMap",
"XkbGetKeyboard",
"XkbGetKeyboardByName",
"XkbGetMap",
"XkbGetMapChanges",
"XkbGetNamedDeviceIndicator",
"XkbGetNamedGeometry",
"XkbGetNamedIndicator",
"XkbGetNames",
"XkbGetPerClientControls",
"XkbGetState",
"XkbGetUpdatedMap",
"XkbGetVirtualMods",
"XkbGetXlibControls",
"XkbIgnoreExtension",
"XkbInitCanonicalKeyTypes",
"XkbKeyTypesForCoreSymbols",
"XkbKeycodeToKeysym",
"XkbKeysymToModifiers",
"XkbLatchGroup",
"XkbLatchModifiers",
"XkbLibraryVersion",
"XkbListComponents",
"XkbLockGroup",
"XkbLockModifiers",
"XkbLookupKeyBinding",
"XkbLookupKeySym",
"XkbNoteControlsChanges",
"XkbNoteDeviceChanges",
"XkbNoteMapChanges",
"XkbNoteNameChanges",
"XkbOpenDisplay",
"XkbQueryExtension",
"XkbRefreshKeyboardMapping",
"XkbResizeDeviceButtonActions",
"XkbResizeKeyActions",
"XkbResizeKeySyms",
"XkbResizeKeyType",
"XkbSelectEventDetails",
"XkbSelectEvents",
"XkbSetAtomFuncs",
"XkbSetAutoRepeatRate",
"XkbSetAutoResetControls",
"XkbSetCompatMap",
"XkbSetControls",
"XkbSetDebuggingFlags",
"XkbSetDetectableAutoRepeat",
"XkbSetDeviceButtonActions",
"XkbSetDeviceInfo",
"XkbSetDeviceLedInfo",
"XkbSetGeometry",
"XkbSetIgnoreLockMods",
"XkbSetIndicatorMap",
"XkbSetMap",
"XkbSetNamedDeviceIndicator",
"XkbSetNamedIndicator",
"XkbSetNames",
"XkbSetPerClientControls",
"XkbSetServerInternalMods",
"XkbSetXlibControls",
"XkbToControl",
"XkbTranslateKey",
"XkbTranslateKeyCode",
"XkbTranslateKeySym",
"XkbUpdateActionVirtualMods",
"XkbUpdateKeyTypeVirtualMods",
"XkbUpdateMapFromCore",
"XkbUseExtension",
"XkbVirtualModsToReal",
"XkbXlibControlsImplemented",
"XmbDrawImageString",
"XmbDrawString",
"XmbDrawText",
"XmbLookupString",
"XmbResetIC",
"XmbSetWMProperties",
"XmbTextEscapement",
"XmbTextExtents",
"XmbTextListToTextProperty",
"XmbTextPerCharExtents",
"XmbTextPropertyToTextList",
"Xpermalloc",
"XrmCombineDatabase",
"XrmCombineFileDatabase",
"XrmDestroyDatabase",
"XrmEnumerateDatabase",
"XrmGetDatabase",
"XrmGetFileDatabase",
"XrmGetResource",
"XrmGetStringDatabase",
"XrmInitialize",
"XrmLocaleOfDatabase",
"XrmMergeDatabases",
"XrmParseCommand",
"XrmPermStringToQuark",
"XrmPutFileDatabase",
"XrmPutLineResource",
"XrmPutResource",
"XrmPutStringResource",
"XrmQGetResource",
"XrmQGetSearchList",
"XrmQGetSearchResource",
"XrmQPutResource",
"XrmQPutStringResource",
"XrmQuarkToString",
"XrmSetDatabase",
"XrmStringToBindingQuarkList",
"XrmStringToQuark",
"XrmStringToQuarkList",
"XrmUniqueQuark",
"Xutf8DrawImageString",
"Xutf8DrawString",
"Xutf8DrawText",
"Xutf8LookupString",
"Xutf8ResetIC",
"Xutf8SetWMProperties",
"Xutf8TextEscapement",
"Xutf8TextExtents",
"Xutf8TextListToTextProperty",
"Xutf8TextPerCharExtents",
"Xutf8TextPropertyToTextList",
"XwcDrawImageString",
"XwcDrawString",
"XwcDrawText",
"XwcFreeStringList",
"XwcLookupString",
"XwcResetIC",
"XwcTextEscapement",
"XwcTextExtents",
"XwcTextListToTextProperty",
"XwcTextPerCharExtents",
"XwcTextPropertyToTextList",
"_Utf8GetConvByName",
"_X11TransBytesReadable",
"_X11TransClose",
"_X11TransCloseForCloning",
"_X11TransConnect",
"_X11TransConnectDisplay",
"_X11TransConvertAddress",
"_X11TransDisconnect",
"_X11TransFreeConnInfo",
"_X11TransGetConnectionNumber",
"_X11TransGetHostname",
"_X11TransGetMyAddr",
"_X11TransGetPeerAddr",
"_X11TransIsLocal",
"_X11TransOpenCLTSClient",
"_X11TransOpenCOTSClient",
"_X11TransRead",
"_X11TransReadv",
"_X11TransSetOption",
"_X11TransWrite",
"_X11TransWritev",
"_XAllocID",
"_XAllocIDs",
"_XAllocScratch",
"_XAllocTemp",
"_XAsyncErrorHandler",
"_XCloseLC",
"_XColor_to_XcmsRGB",
"_XConnectDisplay",
"_XCopyToArg",
"_XDefaultError",
"_XDefaultIOError",
"_XDefaultOpenIM",
"_XDefaultOpenOM",
"_XDefaultWireError",
"_XDeq",
"_XDeqAsyncHandler",
"_XDisconnectDisplay",
"_XEatData",
"_XEnq",
"_XError",
"_XEventToWire",
"_XEventsQueued",
"_XF86BigfontFreeFontMetrics",
"_XF86LoadQueryLocaleFont",
"_XFlush",
"_XFlushGCCache",
"_XFreeAtomTable",
"_XFreeDisplayStructure",
"_XFreeExtData",
"_XFreeTemp",
"_XGetAsyncData",
"_XGetAsyncReply",
"_XGetBitsPerPixel",
"_XGetHostname",
"_XGetLCValues",
"_XGetScanlinePad",
"_XIMCompileResourceList",
"_XIOError",
"_XInitDefaultIM",
"_XInitDefaultOM",
"_XInitDynamicIM",
"_XInitDynamicOM",
"_XInitImageFuncPtrs",
"_XInitKeysymDB",
"_XKeyInitialize",
"_XKeycodeToKeysym",
"_XKeysymToKeycode",
"_XKeysymToModifiers",
"_XLookupKeysym",
"_XLookupString",
"_XOpenLC",
"_XParseBaseFontNameList",
"_XPollfdCacheAdd",
"_XPollfdCacheDel",
"_XPollfdCacheInit",
"_XProcessWindowAttributes",
"_XRead",
"_XReadEvents",
"_XReadPad",
"_XRefreshKeyboardMapping",
"_XRegisterFilterByMask",
"_XRegisterFilterByType",
"_XRegisterInternalConnection",
"_XReply",
"_XReverse_Bytes",
"_XScreenOfWindow",
"_XSend",
"_XSendClientPrefix",
"_XSetClipRectangles",
"_XSetImage",
"_XSetLastRequestRead",
"_XSyncFunction",
"_XTextHeight",
"_XTextHeight16",
"_XTranslateKey",
"_XTranslateKeySym",
"_XUnknownNativeEvent",
"_XUnknownWireEvent",
"_XUnregisterFilter",
"_XUnregisterInternalConnection",
"_XUnresolveColor",
"_XUpdateAtomCache",
"_XUpdateGCCache",
"_XUserUnlockDisplay",
"_XVIDtoVisual",
"_XWireToEvent",
"_XcmsAddCmapRec",
"_XcmsArcTangent",
"_XcmsCIELabQueryMaxLCRGB",
"_XcmsCIELuvQueryMaxLCRGB",
"_XcmsCIEXYZ_ValidSpec",
"_XcmsCIEuvY_ValidSpec",
"_XcmsConvertColorsWithWhitePt",
"_XcmsCopyCmapRecAndFree",
"_XcmsCopyISOLatin1Lowered",
"_XcmsCopyPointerArray",
"_XcmsCosine",
"_XcmsCubeRoot",
"_XcmsDDConvertColors",
"_XcmsDIConvertColors",
"_XcmsDeleteCmapRec",
"_XcmsEqualWhitePts",
"_XcmsFreeIntensityMaps",
"_XcmsFreePointerArray",
"_XcmsGetElement",
"_XcmsGetIntensityMap",
"_XcmsGetProperty",
"_XcmsGetTableType0",
"_XcmsGetTableType1",
"_XcmsInitDefaultCCCs",
"_XcmsInitScrnInfo",
"_XcmsIntensityCmp",
"_XcmsIntensityInterpolation",
"_XcmsLRGB_InitScrnDefault",
"_XcmsMatVec",
"_XcmsPushPointerArray",
"_XcmsRGB_to_XColor",
"_XcmsRegFormatOfPrefix",
"_XcmsResolveColor",
"_XcmsResolveColorString",
"_XcmsSetGetColors",
"_XcmsSine",
"_XcmsSquareRoot",
"_XcmsTableSearch",
"_XcmsTekHVCQueryMaxVCRGB",
"_XcmsTekHVC_CheckModify",
"_XcmsUnresolveColor",
"_XcmsValueCmp",
"_XcmsValueInterpolation",
"_XimGetCharCode",
"_XimGetLocaleCode",
"_XimLookupMBText",
"_XimLookupUTF8Text",
"_XimLookupWCText",
"_XimXTransBytesReadable",
"_XimXTransClose",
"_XimXTransCloseForCloning",
"_XimXTransConnect",
"_XimXTransDisconnect",
"_XimXTransFreeConnInfo",
"_XimXTransGetConnectionNumber",
"_XimXTransGetHostname",
"_XimXTransGetMyAddr",
"_XimXTransGetPeerAddr",
"_XimXTransIsLocal",
"_XimXTransOpenCLTSClient",
"_XimXTransOpenCOTSClient",
"_XimXTransRead",
"_XimXTransReadv",
"_XimXTransSetOption",
"_XimXTransWrite",
"_XimXTransWritev",
"_XkbCopyFromReadBuffer",
"_XkbFreeReadBuffer",
"_XkbGetCharset",
"_XkbGetConverters",
"_XkbGetReadBufferCountedString",
"_XkbGetReadBufferPtr",
"_XkbInitReadBuffer",
"_XkbNoteCoreMapChanges",
"_XkbPeekAtReadBuffer",
"_XkbReadBufferCopyKeySyms",
"_XkbReadCopyKeySyms",
"_XkbReadGetCompatMapReply",
"_XkbReadGetGeometryReply",
"_XkbReadGetIndicatorMapReply",
"_XkbReadGetMapReply",
"_XkbReadGetNamesReply",
"_XkbReloadDpy",
"_XkbSkipReadBufferData",
"_XkbWriteCopyKeySyms",
"_XlcAddCT",
"_XlcAddCharSet",
"_XlcAddGB18030LocaleConverters",
"_XlcAddLoader",
"_XlcAddUtf8Converters",
"_XlcAddUtf8LocaleConverters",
"_XlcCloseConverter",
"_XlcCompareISOLatin1",
"_XlcCompileResourceList",
"_XlcConvert",
"_XlcCopyFromArg",
"_XlcCopyToArg",
"_XlcCountVaList",
"_XlcCreateDefaultCharSet",
"_XlcCreateLC",
"_XlcCreateLocaleDataBase",
"_XlcCurrentLC",
"_XlcDbg_printValue",
"_XlcDefaultLoader",
"_XlcDefaultMapModifiers",
"_XlcDestroyLC",
"_XlcDestroyLocaleDataBase",
"_XlcDynamicLoad",
"_XlcFileName",
"_XlcGetCSValues",
"_XlcGetCharSet",
"_XlcGetCharSetWithSide",
"_XlcGetLocaleDataBase",
"_XlcGetResource",
"_XlcGetValues",
"_XlcInitCTInfo",
"_XlcInitLoader",
"_XlcLocaleDirName",
"_XlcMapOSLocaleName",
"_XlcNCompareISOLatin1",
"_XlcOpenConverter",
"_XlcParseCharSet",
"_XlcParse_scopemaps",
"_XlcRemoveLoader",
"_XlcResetConverter",
"_XlcResolveI18NPath",
"_XlcResolveLocaleName",
"_XlcSetConverter",
"_XlcSetValues",
"_XlcVaToArgList",
"_XlcValidModSyntax",
"_Xlcmbstoutf8",
"_Xlcmbstowcs",
"_Xlcmbtowc",
"_Xlcwcstombs",
"_Xlcwctomb",
"_XmbTextListToTextProperty",
"_XmbTextPropertyToTextList",
"_Xmblen",
"_Xmbstoutf8",
"_Xmbstowcs",
"_Xmbtowc",
"_XrmDefaultInitParseInfo",
"_XrmInitParseInfo",
"_XrmInternalStringToQuark",
"_Xutf8TextListToTextProperty",
"_Xutf8TextPropertyToTextList",
"_XwcFreeStringList",
"_XwcTextListToTextProperty",
"_XwcTextPropertyToTextList",
"_Xwcscmp",
"_Xwcscpy",
"_Xwcslen",
"_Xwcsncmp",
"_Xwcsncpy",
"_Xwcstombs",
"_Xwctomb",
};

static int
xstrcmp(const void *key, const void *elem)
{
	const char *a = (const char *)key;
	const char *b = *(const char **)elem;
	return strcmp(a, b);
}

int
in_xlib(char *name)
{
	if (bsearch(name, xfns, sizeof(xfns)/sizeof(xfns[0]),
		    sizeof(xfns[0]), xstrcmp))
		return 1;
	else
		return 0;
}
